# 멀티캠퍼스 IP 설정 자동화 스크립트

## 개요

- 노트북을 반출해서 사용하긴 해야 하는데..
- 매번 네트워크 설정을 하기가 귀찮았던 당신을 위한 자동화 스크립트 파일~
- 노트북을 킬 때마다 실행되어 자동으로 네트워크 설정을 진행해드립니다!
- 초기 세팅을 진행하면 이후부터는 추가적인 설정 없이 동작합니다.

## 구조
![image](https://github.com/Zerotay/gunfra/assets/67823010/67a1fdd2-5619-45b4-8268-80d3ac74a64d)

- allow_on_batteries.ps1 - 배터리 구동 상황 관련 파일
- AUTO_IP_SETTING.bat - 자동화 스크립트 파일
- delete.bat - 자동 설정 off
- env.txt - 세팅 값들이 들어가는 파일
- init.bat - 자동 설정 on
- README.md - 설명 문서

## 사용법

- 초기 세팅

  - 이 디렉터리를 사용자 홈 디렉터리(C:\Users\SSAFY) 바로 밑에 위치시켜주세요.
  - `env.txt` 파일을 메모장으로 열어서 각종 값을 넣어주세요.

    ```bash
    set INTERFACE=인터페이스명
    set WIFI=연결할 wifi명
    set IP=11.11.11.11
    set SUBNET=255.255.255.255
    set GATEWAY=11.11.11.1
    set DNS1=123.123.123.123
    set DNS2=123.123.123.123
    ```

    - IP ~ DNS2는 SSAFY에서 제공받은 값을 입력해주세요.
    - 인터페이스명은 win+q 이후 "네트워크 연결 보기"를 검색하여 파악할 수 있습니다. Wi-Fi거나, Wi-Fi 2일 겁니다.
      ![interface확인](https://github.com/Zerotay/gunfra/assets/67823010/bdcf0e8c-823b-4a83-856b-5056616b121f)

    - WIFI는 연결할 wifi 이름을 적어주시면 됩니다.

  - 설정이 완료되었다면 `init.bat`을 더블클릭해 실행해주세요.
  - 완료됐습니다!
  - `init.bat`, `delete.bat` 을 실행 시 기능을 on/off 할 수 있습니다.

## 참고사항

- 개선사항, 버그 관련 제보 환영합니다
- Made By 싸피 10기 1045374 김동건
- Contributor : 싸피 10기 강이규, 김도현
- Ver 2.2.0

## <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>

# 간략 버전 정보 정리

## 버전 1.0

- 대화형 스크립트
- 사용자의 입력으로 개인 설정 정보를 실행 때마다 받음
- 사용자의 입력으로 설정 여부를 선택할 수 있음
- 매번 하기 매우 귀찮음;;

## 버전 1.1

- 토글형 스크립트
- 사용자는 파일 편집을 통해 처음 개인 설정 정보를 입력
- 이후부터는 단순하게 스크립트를 실행시켜서 설정을 키고 끌 수 있음

## 버전 2.0

- 자동형 스크립트
- 윈도우 서비스에 등록하여 컴퓨터를 실행하면 자동 네트워크 세팅이 일어나도록(https://haenny.tistory.com/209) -> 실패
  - 윈도우를 키면 실행되는 디렉터리에 위치시킴
- 설계 방향
  - dhcp 원리 공부. 라우터에 브로드캐스트로 요청을 보내고 무응답일 때 멀캠 설정
  - ping 사용. 근데 이 방법은 ip 설정 이슈 뿐만 아니라 일단 와이파이가 제대로 연결됐다는 것 자체가 전제돼야만 해서 추가 이슈가 발생할 것 같다.
  - 현재 가용한 공유기 이름 확인. SSAFY의 공유기 이름이 있으므로 그걸 활용 -> 채택
- bat 파일을 직접 수정하는 것이 사용성을 떨어뜨림 -> 설정 파일 분리
- 추가 과제 - 절전 상태에서 켜지는 것에 대해서도 설정할 수는 없을까?

## 버전 2.1

- 자동형 스크립트
- 잠금 해제되는 정확한 윈도우 이벤트를 포착하여 작업 스케줄러로 스크립트 등록
  ![image](https://github.com/Zerotay/gunfra/assets/67823010/a2420095-5670-4972-bac8-4de087553a57)
  - 갖은 노력의 흔적..
- 단순 로그온 이벤트인 4624는 잘 실행되고 있을 때도 시도때도 없이 터진다.
- 로그온 타입이 세부적으로 나뉘어 있기에 이걸 잘 찾아서 설정을 걸어주면 되겠다고 판단
- 왜 안되나 싶었는데.. 해답은 xml 파일을 뜯어보는 것에 있었음
- 로그온타입이 속성으로 들어가있기 때문에 @을 달아서 조건을 걸어주어야만 함
- 그냥 단순히 이쁘게 gui로 표현된 정보에는 드러나있지 않은 방식이었음

## 버전 2.2

- 노트북이 배터리로 사용될 때는 스크립트가 자동으로 발생하지 않는 이슈  
  ![image](https://github.com/Zerotay/gunfra/assets/67823010/88c0e4ab-1a28-4067-9183-9468b525f6cb)

  - 이러한 설정이 기본값으로 걸려있었음. 전원 연결 안 돼있을 시 실행되지 않음
  - 단순히 cmd 환경에서는 설정할 수 없다고 함(왜..? cmd 안 챙기나..?)
    - 파일을 xml 형식으로 export시킨 후 관련 부분만 수정해서 새로 등록하기
    - 아니면 파워쉘 사용하기
  - xml 파일을 건드리는 것에 대해서도 말끔한 설정 방식을 지원해주지 않는 것으로 보여 조금 더 사용자 친화적으로 설정할 수 있을 것으로 기대되는 파워쉘 활용 결정
  - allow_on_batteries.ps1(ps1은 파워쉘 확장자) 생성
  - 추가 구현 과제
    - 어차피 싸피 내에서 노트북 사용할 때 이미 세팅된 값들이 있으니 이걸 읽어서 사용자가 초기 세팅할 때 설정값을 기입 안 해도 되게 할 수 있다.
    - 솔직히 dns, subnet, gateway 어디에서 해도 안 바뀌는 값인데 굳이 사용자한테 받아올 필요가 있겠느냐 -> 전국에서 동일할지 궁금
